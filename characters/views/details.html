<div class="backdrop" ui-sref="^"></div>

<div class="inner-container" go-back>

    <div class="custom-modal">
        <div class="modal-dialog">
            <div class="modal-content animated rollIn">

                <div class="modal-header">
                    <div class="fa fa-arrow-left btn btn-default back-button" ng-if="withButton" ng-click="onBackClick()"></div>    
                    {{unit.name}}
                </div>

                <div class="modal-body" ng-class="{ preview: unit.preview }">

                    <div ng-if="!unit.incomplete" class="slot huge" decorate-slot big="true" uid="unit.number + 1"></div>

                    <div ng-if="unit.preview" class="alert alert-warning">
                        <b>WARNING:</b> Currently viewing the preview of an upcoming unit not yet released, the information provided may not be accurate.
                    </div>

                    <div ng-if="unit.incomplete && !unit.preview" class="alert alert-danger">
                        This unit's complete information is still partially missing and will soon be added.
                    </div>

                    <h3 class="page-header">
                        Details
                        <i ng-if="compare" ng-click="clearComparison()" class="fa fa-times pull-right" id="compare-clear" title="clear"></i>
                        <input compare type="text" id="compare" class="pull-right" placeholder="Compare with..."></input>
                    </h3>

                    <div class="panel panel-default stats-pane">
                        <table class="table table-striped">
                            <tbody>
                                <tr>
                                    <th>Weapon</th>
                                    <th>Element</th>
                                    <th>Rarity</th>
                                </tr>
                                <tr>
                                    <td>{{unit.weapon}}</td>
                                    <td>{{unit.element}}</td>
                                    <td ng-if="!compare">{{unit.rarity}}</td>
                                    <td ng-if="compare" comparison="positive">{{unit.rarity - compare.rarity}}</td>
                                </tr>
                                <tr>
                                    <th>HP</th>
                                    <th>ATK</th>
                                    <th>Critical</th>
                                </tr>
                                <tr>
									<td ng-if="!compare">{{unit.HP}}</td>
									<td ng-if="compare" comparison="positive">{{unit.HP - compare.HP}}</td>
									<td ng-if="!compare">{{unit.ATK}}</td>
									<td ng-if="compare" comparison="positive">{{unit.ATK - compare.ATK}}</td>
									<td ng-if="!compare">{{unit.Critical}}</td>
									<td ng-if="compare" comparison="positive">{{unit.Critical - compare.Critical}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="page-header" ng-hide="hidden.stats">Stats</h3>

                    <uib-tabset ng-hide="hidden.stats">
                        <uib-tab heading="Stats">
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th>MP</th>
                                        <th>Defense</th>
                                        <th>Cost</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>                                        
										<td ng-if="!compare">{{unit.MP}}</td>
										<td ng-if="compare" comparison="negative">{{unit.MP - compare.MP}}</td>
										<td ng-if="!compare">{{unit.Defense}}</td>
										<td ng-if="compare" comparison="negative">{{unit.Defense - compare.Defense}}</td>
										<td ng-if="!compare">{{unit.cost}}</td>
										<td ng-if="compare" comparison="negative">{{unit.cost - compare.cost}}</td>
                                </tbody>
                            </table>
                        </uib-tab>
                    </uib-tabset>

                   

                    <!-- Drops | banners? -->

                    <h3 class="page-header" ng-if="drops.length > 0">Drop Locations</h3>

                    <span ng-show="!collapsed.drops" class="drop-warning">
                        <strong>Note:</strong>
                        If a drop appears in almost all of the stages of a story-mode island, it is likely to be part of the
                        island's secret round. Secret rounds have an estimated 5% chance of appearing.
                    </span>

                    <table ng-if="collapsed.drops && drops.length > 3" class="table table-striped table-centered table-bordered table-textless">
                        <tbody>
                            <tr ng-if="collapsed.drops && drops.length > 3">
                                <td><button class="btn btn-info collapse-button"
                                        ng-click="collapsed.drops = false">Click to show</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <table ng-if="drops.length > 0" class="table table-striped drop-table">
                        <thead ng-show="!collapsed.drops || drops.length < 4">
                            <tr>
                                <th>Location</th>
                                <th>Chapter/Difficulty</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-if="!collapsed.drops || drops.length < 4" ng-repeat="drop in drops">
                                <td>
                                    <div class="slot small" decorate-slot uid="drop.thumb"></div>
                                    <a href="{{'../drops/?'+drop.name}}" target="_blank">{{drop.name}}</a>
                                    <span ng-repeat="bonus in drop.bonuses" class="bonus {{bonus.slice(0,2)}} {{bonus.slice(3)}}"></span>
                                </td>
                                <td>{{drop.data.join(', ')}}</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Manuals -->

                    <h3 class="page-header" ng-if="manuals.length > 0">Manual Locations</h3>

                    <table ng-if="collapsed.manuals && manuals.length > 3" class="table table-striped table-centered table-bordered table-textless">
                        <tbody>
                            <tr ng-if="collapsed.manuals && manuals.length > 3">
                                <td><button class="btn btn-info collapse-button"
                                        ng-click="collapsed.manuals = false">Click to show</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <table ng-if="manuals.length > 0" class="table table-striped drop-table">
                        <thead ng-show="!collapsed.manuals || manuals.length < 4">
                            <tr>
                                <th>Location</th>
                                <th>Stage/Difficulty</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-if="!collapsed.manuals || manuals.length < 4" ng-repeat="drop in manuals">
                                <td>
                                    <div class="slot small" decorate-slot uid="drop.thumb"></div>
                                    <a href="{{'../drops/?'+drop.name}}" target="_blank">{{drop.name}}</a>
                                </td>
                                <td>{{drop.data.join(', ')}}</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Family -->

                    <h3 class="page-header" ng-if="families.length > 0">Family: {{family}}</h3>

                    <table ng-if="collapsed.families && families.length > 3" class="table table-striped table-centered table-bordered table-textless">
                        <tbody>
                            <tr ng-if="collapsed.families && families.length > 3">
                                <td><button class="btn btn-info collapse-button"
                                        ng-click="collapsed.families = false">Click to show farmable versions</button></td>
                            </tr>
                        </tbody>
                    </table>

                    <table ng-if="families.length > 0" class="table table-striped drop-table">
                        <thead ng-show="!collapsed.families || families.length < 4">
                            <tr>
                                <th>Variant</th>
                                <th>Farm Location</th>
                                <th>Chapter/Difficulty</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-if="!collapsed.families || families.length < 4" ng-repeat="data in families">
                                <td>
                                    <div class="slot small" decorate-slot uid="data.uid"></div>
                                    <a ui-sref="main.search.view({ id: data.uid, previous: getPrevious() })">{{data.name}}</a>
                                </td>
                                <td><a href="{{'../drops/?'+data.location.name}}" target="_blank">{{data.location.name}}</a></td>
                                <td>{{data.location.data.join(', ')}}</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <!-- Other Names -->
                    
                    <h3 class="page-header">Other Names</h3>
                    
                    <add-names></add-names>

                    <!-- Tags -->

                    <h3 class="page-header">Tags</h3>
                    
                    <add-tags></add-tags>

                    <!-- Links -->

                    <br/>
                    <h3 class="page-header">Links</h3>
                    
                    <add-links></add-links>

                    <!-- Data gathering -->

                    <div ng-if="!unit.incomplete && unit.growth.atk === 0" class="alert alert-success"><i class="fa fa-star"></i> Have this unit? Please take a look at <a href="../damage/#/gather">this</a>.</div>

                </div>

            </div>
        </div>

    </div>

</div>
